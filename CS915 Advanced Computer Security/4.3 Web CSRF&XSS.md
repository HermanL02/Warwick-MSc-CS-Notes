# Pre-Lecture Questions Nov. 06
1. TOCTTOU is an example of the race condition attack? Ans. Yes
2. What is a Set-UID program? Ans. A program that can be run by a user but with the program owner's privilege
3. In a Set-UID program, what are the real UID and effective UID?
ANS. 
**Real UID is equal to the user ID**
Real UID is equal to the program owner's ID
Effective UID is qual to the user ID
**Effective UID is equal to the program owner's ID**
4. The following is a set-UID program. Does it have a race condition problem? ![[Pasted image 20231106111159.png]] ANS. Yes
5. You have discovered the following line in /etc/passwd. Explain why test has the root access to the system?
![[Pasted image 20231106111307.png]]
The user id is 0. 
6. Which of the following are countermeasures against race condition attacks?
ANS. **Use atomic operations
Prevent arbitrary setting of symlinks
Apply least privilege**
Do not use SET_UID programs

# Contents
## CSRF 
- Cross Site Request Forgery 
- Performed on HTTP GET and HTTP POST
- Countermeasures
## XSS 
- Two types of XSS attacks
- Countermeasures

# Requests 
Same-site request: 
A page sends HTTP request and back to the same website. 

Cross-site request: 
A page sends HTTP request to a different website. 

# Cookie 
- A packet of info
- From server to client (First Authorize)
- From client to server (When client access the website)
# Cross-Site Request Problems
The same cookies if send from different devices, the website cannot know. 

# Cross-Site Requests Forgery Attack
1. The attacker forge a website
2. The victim log to this fake website
3. The website send cookies to user
4. The attacker use cookies to log to the real website

# CSRF Attack on Requests

## GET request
Example: http://www.bank32.com/transfer.php?to=3220&amount=500
The attacker send this request to the server through the victim's session cookies. 

Easy way to understand: Phishing buttons 钓鱼按钮
## POST request 
Post request = Form Submit
So if the user clicks the submit button, the post request will be sent. 

Same above, use JavaScript to submit the form automatically. 

# Cause

- Server cannot distinguish the source of the request
- Browser would know the difference
# Countermeasures 
## Referer Header (Done by browser)

- HTTP Header contains the address of the web page from where the request is generated. 
- Server knows whether it is sent from its own website
- 停止使用: Exposures users browser history
## Same-Site Cookies (Done by browser)
1. Same-Site variable inside the browser
2. Can be set to Strict or Lax
## Secret Token (Done by browser)
- Embeds a secret value
- After request initiated from the page, the secret value is stored in the request. 
- The server checks this value every time to see if this request is cross-site
- So guaranteed not shared to the other site (through browser's policy)

